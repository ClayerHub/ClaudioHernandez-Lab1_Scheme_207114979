#lang racket
;El TDA de la fecha utilizara como base el "ejemplo de implementacion TDA Fecha (RG) subido en uvirtual como apoyo
;Este TDA representa una fecha, donde se incluye el dia, mes y año. Estos datos seran guardados en una lista que lleve el mismo orden
;(Mes) Int X (Dia) Int X (Año) Int


;Funcion que permite crear una fecha, la cual la entrega en una lista
(define (fecha-lista dia mes anio)
  (if
   (and (integer? dia) (integer? mes) (integer? anio)
   (> dia 0) (< 32) (> mes 0) (< mes 13) (not (= anio 0)))
  (list dia mes anio)
  null))

;Funcion que determina si el elemento introducido es del tipo fecha
(define (fecha? f)
  (and (list? f) (= 3 (length f)) (not(null? (fecha (car f) (cadr f) (caddr f))))))

;Funcion que retorna el dia de una fecha
(define (get-dia f)
  (if (fecha? f) (car f)
      0))

;Funcion que retorna el mes de una fecha
(define (get-mes f)
  (if (fecha? f) (cadr f)
      0))

;Funcion que retorna el año de una fecha
(define (get-anio f)
  (if (fecha? f) (caddr f)
      0))

;Funcion que determina si el elemento entero introducido es bisiesto
(define (bisiesto? anio)
  (if (and(integer? anio) (not (= anio 0)))
      (or (= (remainder anio 400) 0)
          (and (= (remainder anio 4) 0)(not (= (remainder anio 100) 0))))
      #f))

;Funcion que calcula cuantos dias tiene el mes
(define (get-dias-del-mes mes anio)
  (if (and (integer? mes) (integer? anio) (not (= anio 0)) (> mes 0) (< mes 13))
      (if (or (= mes 1) (= mes 3) (= mes 5) (= mes 7) (= mes 8) (= mes 10) (= mes 12)) 31
          (if (= mes 2) (if (bisiesto? anio) 29
                            28)
              30))
      0))
;Funcion que revisa el mes en entero y lo pasa a su string correspondiente
(define (name-month nombre-del-mes)
  (cond ((= nombre-del-mes 1) "Enero")
        ((= nombre-del-mes 2) "Febrero")
        ((= nombre-del-mes 3) "Marzo")
        ((= nombre-del-mes 4) "Abril")
        ((= nombre-del-mes 5) "Mayo")
        ((= nombre-del-mes 6) "Junio")
        ((= nombre-del-mes 7) "Julio")
        ((= nombre-del-mes 8) "Agosto")
        ((= nombre-del-mes 9) "Septiembre")
        ((= nombre-del-mes 10) "Octubre")
        ((= nombre-del-mes 11) "Noviembre")
        ((= nombre-del-mes 12) "Diciembre"))) 

;provide permite utilizar las funciones del TDA en otros archivos
(provide (all-defined-out))